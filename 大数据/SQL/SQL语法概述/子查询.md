### 子查询

子查询（Subquery）是嵌套在另一个查询中的查询。在关系代数中，子查询通常用于选择操作（σ），投影操作（π），以及它们的组合中，用于提供过滤条件或值比较。



#### 子查询的各种形式

> 子查询可以根据它们在查询中的位置、用途以及它们如何影响查询结果，被划分为不同的类别。

1. 标量子查询（Scalar Subquery）

- 返回单个值的子查询。
- 常用于SELECT列表中、WHERE子句中的比较操作，或者作为计算表达式的一部分。

2. 关联子查询（Correlated Subquery）

- 引用外部查询中的列。
- 每当外部查询的行被处理时，关联子查询都会被重新执行。

3. 派生表（Derived Tables）/内联视图（Inline Views）

- 在FROM子句中使用的子查询。
- 为外部查询提供一个临时表。
- 允许在其上执行JOIN操作、WHERE过滤等。

4. EXISTS （NOT EXISTS）子查询

- 用于测试是否存在满足特定条件的行。
- 通常与关联子查询结合使用。

6. IN （not in）子查询

- 用于测试某个值是否存在于子查询返回的值列表中。
- 常用于WHERE子句中。

7. 集合比较子查询

   ANY 或 SOME 子查询， ALL 子查询

- 与单个值的比较操作结合使用，ANY/SOME用于测试是否至少有一个子查询返回的值满足比较条件，而ALL要求所有返回值都满足条件



区分和定义的依据

- **位置**：子查询可以在SELECT、FROM、WHERE、HAVING等子句中使用。
- **返回值**：子查询可以返回单个值、值列表或整个表。
- **依赖性**：子查询可以是独立的，也可以是关联的，后者依赖于外部查询的结果。

#### 子查询返回的结果集

返回值的查询（标量子查询）、返回一行的查询（行子查询）或返回多行多列的查询（表子查询）。子查询可以用在 `SELECT` 语句的列列表中、`FROM` 子句中、或者作为条件表达式中的一部分。

**标量子查询**

标量子查询（Scalar Subquery）是一种 SQL 查询，它返回单个值（即，单个行和单个列的结果）。

常用于SELECT列表中、WHERE子句中的比较操作，或者作为计算表达式的一部分。

```sql
col Comparison_Operators (select agg_fun()  from ....)    
```

**行子查询**

行子查询（Row Subqueries）返回一行多列的结果，可以与外部查询中的多个列进行比较。实际上是元组的匹配。

```sql
( col_1, col_2,,,,)  Comparison_Operators  ( select col_1, col_2,,, from ...)  -- 元组匹配 
```

**表子查询**
派生表（Derived Tables）/内联视图（Inline Views）

- 在FROM子句中使用的子查询。
- 为外部查询提供一个临时表。
- 允许在其上执行JOIN操作、WHERE过滤等。



#### 子查询的位置

select 、from、where、having、join、insert、update、delete











