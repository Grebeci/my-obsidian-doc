数仓是BI的重要组件


数据结构：使用hive 把数据映射成二维表，换句话说，hive在数仓的地位就是维护数据结构。

数据分析：OLAP，OLTP

离线数仓： 离线含义是批处理，按照时间分批，一般是T+1


调度工具：

批处理之前有任务的依赖，利用调度工具编排任务的前后顺序。

框架：
azkaban，OOize，Dolphin Scheduler 




数仓四部分

数据同步

建模

报表（展示）


建模服务于数据分析，所以是需求推动的

错误的理解
- 先有建模，然后针对需求出报表？
- 等建模完成才能出报表，应对需求？
- 一堆表要识别出哪些是维度表哪些是事实表？（事实表和维度表都是根据需要从ODS抽取的

> 实际上，从0到1的数仓，刚开始大家都是去快速搭建一个指标体系，也就是每天相应一些数据分析需求。
> 
> 有很多需求是长期重复的，为了快速相应这类需求，大家会把一些表规范化，便于以后快速响应。
> 

数仓建模是对报表需求的抽象，把经常join的表宽表化，使用预聚合的思想，把一些中间表落盘，减少后续的统计。

> 比如分类统计每月热销商品，我们可以把围绕商品，把订单表，商品表，活动表形成dwd宽表；使用预聚合思想，每天先把每天的热销商品统
> 计出来。

维度模型和ER模型不冲突，ER模型分析需要哪些字段，维度模型用来整合指标

> 我们要分析三个指标
> 1. 每类商品的在每年每月下的购买次数（商品购买次数）
> 2. 复购某些品牌人数 >= 1000 的品牌（ 热销品牌）
> 3. 消费分层（每种消费区间的人数）
> 第一个指标： 商品实体，订单实体，关联关系是商品id，所以需要属性 商品（商品id，商品名称，商品分类）订单（订单id，商品id） 
> 第二个指标：品牌， 商品，订单。品牌（id，name） 商品id，订单（id，user_id)
> 第三个指标： 订单，用户 ， 订单（订单id，下单金额） 用户（id，性别）
> 
> 这三个指标都是根据不同的角度看订单，用户角度，商品角度，品牌角度（冗余在商品角度上）。所以建立维度表 用户表，商品表，交易订单表（订单明细和订单表关联） 


我说一个应用场景把，我们公司经常搞活动发优惠卷，这些优惠卷发给谁主要看三个指标，这些都是通过，用户维度和商品维度看订单表。所以我们把订单表当成事实表，用户，商品看成维度。

然后我们构建商品主题表（商品每日购买次数，购买金额，我们可以把商品各种信息退化到里面，品牌，类别，以后商品类指标都从这张表上出）

构建用户下单表，把用户各种信息，订单的各种信息都冗余到里面。














